{% extends "base.html" %}

{% block title %}–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è - Bitrix24 Security Audit{% endblock %}

{% block head %}
<style>
    /* Matrix rain effect */
    .matrix-rain {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: -1;
        overflow: hidden;
    }
    
    .matrix-column {
        position: absolute;
        top: -100px;
        color: var(--cyber-primary);
        font-family: 'Courier New', monospace;
        font-size: 14px;
        line-height: 14px;
        opacity: 0.7;
        animation: matrix-fall linear infinite;
    }
    
    @keyframes matrix-fall {
        0% {
            transform: translateY(-100px);
            opacity: 1;
        }
        100% {
            transform: translateY(100vh);
            opacity: 0;
        }
    }
    
    .hacker-text {
        font-family: 'Courier New', monospace;
        color: var(--cyber-primary);
        text-shadow: 0 0 10px rgba(0, 255, 65, 0.8);
    }
    
    .login-footer {
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 0.8rem;
        color: var(--text-muted);
    }
</style>
{% endblock %}

{% block content %}
<!-- Matrix Rain Background -->
<div class="matrix-rain" id="matrixRain"></div>

<div class="login-container">
    <div class="login-card">
        <!-- System Header -->
        <div class="text-center mb-4">
            <i class="fas fa-shield-alt fa-3x text-cyber-primary glow mb-3"></i>
            <h1 class="login-title glow">SYSTEM ACCESS</h1>
            <div class="hacker-text mb-3">
                <small>
                    > BITRIX24 SECURITY AUDIT SYSTEM<br>
                    > AUTHORIZATION REQUIRED<br>
                    > UNAUTHORIZED ACCESS PROHIBITED
                </small>
            </div>
        </div>
        
        <!-- Terminal-style Login Form -->
        <form method="POST" class="needs-validation" novalidate>
            <div class="mb-4">
                <div class="hacker-text mb-2">
                    <small>> ENTER USERNAME:</small>
                </div>
                <div class="input-group">
                    <span class="input-group-text bg-cyber-primary text-dark">
                        <i class="fas fa-user"></i>
                    </span>
                    <input type="text" 
                           class="form-control" 
                           id="username" 
                           name="username" 
                           placeholder="root@audit.system" 
                           required>
                </div>
            </div>
            
            <div class="mb-4">
                <div class="hacker-text mb-2">
                    <small>> ENTER PASSWORD:</small>
                </div>
                <div class="input-group">
                    <span class="input-group-text bg-cyber-primary text-dark">
                        <i class="fas fa-key"></i>
                    </span>
                    <input type="password" 
                           class="form-control" 
                           id="password" 
                           name="password" 
                           placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" 
                           required>
                    <button type="button" 
                            class="btn btn-outline-primary" 
                            onclick="togglePassword()"
                            id="togglePasswordBtn">
                        <i class="fas fa-eye" id="togglePasswordIcon"></i>
                    </button>
                </div>
            </div>
            
            <!-- System Status -->
            <div class="mb-4">
                <div class="d-flex justify-content-between align-items-center">
                    <small class="text-cyber-accent">
                        <i class="fas fa-circle pulse text-cyber-success"></i> 
                        SYSTEM ONLINE
                    </small>
                    <small class="text-muted">
                        <i class="fas fa-lock"></i> 
                        SECURE CONNECTION
                    </small>
                </div>
            </div>
            
            <div class="d-grid mb-3">
                <button type="submit" class="btn btn-primary btn-lg pulse">
                    <i class="fas fa-sign-in-alt"></i> 
                    INITIALIZE SESSION
                </button>
            </div>
        </form>
        
        <!-- System Info -->
        <div class="text-center">
            <small class="text-muted">
                <i class="fas fa-info-circle"></i>
                –°–∏—Å—Ç–µ–º–∞ –∑–∞—â–∏—â–µ–Ω–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è AES-256<br>
                –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: admin / admin123
            </small>
        </div>
        
        <!-- Terminal cursor blink -->
        <div class="hacker-text text-center mt-3">
            <small id="terminalCursor">> WAITING FOR INPUT_</small>
        </div>
    </div>
</div>

<!-- Login Footer -->
<div class="login-footer">
    <div class="hacker-text text-center">
        <small>
            AKUMA SECURITY SYSTEMS &copy; 2024<br>
            "In code we trust, in security we excel"
        </small>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Matrix Rain Effect
function createMatrixRain() {
    const matrixRain = document.getElementById('matrixRain');
    const characters = '01„Ç¢„Ç§„Ç¶„Ç®„Ç™„Ç´„Ç≠„ÇØ„Ç±„Ç≥„Çµ„Ç∑„Çπ„Çª„ÇΩ„Çø„ÉÅ„ÉÑ„ÉÜ„Éà„Éä„Éã„Éå„Éç„Éé„Éè„Éí„Éï„Éò„Éõ„Éû„Éü„É†„É°„É¢„É§„É¶„É®„É©„É™„É´„É¨„É≠„ÉØ„É≤„É≥ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    
    function createColumn() {
        const column = document.createElement('div');
        column.className = 'matrix-column';
        column.style.left = Math.random() * 100 + '%';
        column.style.animationDuration = (Math.random() * 3 + 2) + 's';
        
        let text = '';
        for(let i = 0; i < 20; i++) {
            text += characters[Math.floor(Math.random() * characters.length)] + '<br>';
        }
        column.innerHTML = text;
        
        matrixRain.appendChild(column);
        
        setTimeout(() => {
            if(column.parentNode) {
                column.parentNode.removeChild(column);
            }
        }, 5000);
    }
    
    // Create new columns periodically
    setInterval(createColumn, 200);
}

// Terminal cursor blink
function blinkCursor() {
    const cursor = document.getElementById('terminalCursor');
    let visible = true;
    
    setInterval(() => {
        if(visible) {
            cursor.innerHTML = '> WAITING FOR INPUT_';
        } else {
            cursor.innerHTML = '> WAITING FOR INPUT';
        }
        visible = !visible;
    }, 500);
}

// Password toggle
function togglePassword() {
    const passwordField = document.getElementById('password');
    const toggleIcon = document.getElementById('togglePasswordIcon');
    
    if(passwordField.type === 'password') {
        passwordField.type = 'text';
        toggleIcon.className = 'fas fa-eye-slash';
    } else {
        passwordField.type = 'password';
        toggleIcon.className = 'fas fa-eye';
    }
}

// Form validation with hacker style
function validateForm() {
    const forms = document.querySelectorAll('.needs-validation');
    
    Array.prototype.slice.call(forms).forEach(function(form) {
        form.addEventListener('submit', function(event) {
            if (!form.checkValidity()) {
                event.preventDefault();
                event.stopPropagation();
                
                // Add error styling
                const invalidInputs = form.querySelectorAll(':invalid');
                invalidInputs.forEach(input => {
                    input.style.borderColor = 'var(--cyber-danger)';
                    input.style.boxShadow = '0 0 10px rgba(255, 68, 68, 0.5)';
                });
            }
            
            form.classList.add('was-validated');
        }, false);
    });
}

// Initialize everything when page loads
document.addEventListener('DOMContentLoaded', function() {
    createMatrixRain();
    blinkCursor();
    validateForm();
    
    // Add typing effect for terminal text
    const terminalTexts = document.querySelectorAll('.hacker-text small');
    terminalTexts.forEach((text, index) => {
        setTimeout(() => {
            text.style.opacity = '0';
            setTimeout(() => {
                text.style.opacity = '1';
                text.style.transition = 'opacity 0.5s ease';
            }, index * 200);
        }, index * 100);
    });
});

// Add sound effects (optional - can be enabled later)
function playSound(soundName) {
    // Placeholder for keyboard click sounds
    // Can add audio files later
}

// Add keyboard event listeners for authentic feel
document.addEventListener('keydown', function(e) {
    if(e.target.tagName === 'INPUT') {
        // Add subtle glow on typing
        e.target.style.boxShadow = '0 0 15px rgba(0, 255, 65, 0.5)';
        setTimeout(() => {
            e.target.style.boxShadow = '0 0 10px rgba(0, 255, 65, 0.3)';
        }, 200);
    }
});

// Easter egg: Konami code
let konamiCode = [];
const konamiSequence = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'KeyB', 'KeyA'];

document.addEventListener('keydown', function(e) {
    konamiCode.push(e.code);
    if(konamiCode.length > konamiSequence.length) {
        konamiCode.shift();
    }
    
    if(JSON.stringify(konamiCode) === JSON.stringify(konamiSequence)) {
        // Easter egg activated!
        document.body.style.animation = 'glow 1s infinite';
        setTimeout(() => {
            document.body.style.animation = '';
        }, 5000);
        console.log('üî• AKUMA MODE ACTIVATED! The Matrix has you...');
    }
});
</script>
{% endblock %}
